## domainオブジェクト
インスタンス変数を返すだけのgetterメソッドは本来のメソッドとしておかしい
呼び出す側のロジックを移植したメソッドを生やす
1. データを持つ側のクラスにロジックが増える
2. データをgetしていたクラスからロジックが消える
3. 使う側のクラスはデータをgetするのでは無く、そのデータを使った計算結果を受け取るようにする


メソッドは必ずインスタンス変数を使う
インスタンス変数を使わないメソッドはそのクラスのメソッドとしては不適切
データ(インスタンス変数)の近くにロジックを置く


クラスが肥大化したら切り出す
メソッドとそこで使っているインスタンス変数を切り出す


関連性の強いクラスは同じパッケージに集める
クラスやメソッドのスコープは可能な限りパッケージスコープにする
https://www.javaroad.jp/java_class7.htm
可能な限りパッケージスコープにする


Domainのサービス層(ドメインサービス)はいくつかのdomainを触って良い
controllerから使用するサービスとは別物


パッケージ図
個々のクラスを隠蔽し、パッケージ単位で全体を俯瞰する
受注オブジェクトは顧客オブジェクトと商品オブジェクトと在庫オブジェクトを参照する。
これは業務の流れを逆に辿った関係
業務フローの最初に登場するオブジェクト(顧客、商品、在庫)は後から登場するオブジェクト(受注)を知らない

## domainサービス
- エンティティや値オブジェクトの責務ではないドメインモデルのロジック（複数のドメインオブジェクトを使って計算する処理やファサード）
- https://blog.j5ik2o.me/entry/2013/05/11/020200


## domainモデル
- ドメインモデル(domain.model)
- 業務アプリケーションの部品となるドメインオブジェクトを集めて整理した部品の倉庫
- If文の入れ子構造になったらクラスを切り出す事を検討する
- domainオブジェクトにフレームワークの都合を持ち込んではいけない(アノテーション、カラムとか)
  それはdtoやinfrastructureでやる


## infrastructure層
技術とアプリケーションを分ける際に技術を置く
- dao, dto, repositoryImpl(データソース)など 
implはインフラストラクチャに置く
repositoryはdomain

dtoはテーブルと一対一ではない
Entityはテーブルと一対一
この2つは微妙なとこ↑



## adapter層
- adptar(外界との接着点)はI/Oの入れ替えクラスも置いて良い(converterなど)
- controller, infrastructure, middleweareなどが入る
- ユーザーインターフェイス層のバリデーションはあくまで粗いレベルのバリデーションに留める
- ユーザーインターフェイスがドメインモデルのオブジェクトを使う場合は、単にそのデータをレンダリングするだけにする


## application層
- アプリケーション層は業務処理の進行役であり調整役
三層アーキテクチャ
プレゼンテーション層 -> コントローラー
アプリケーション層 -> サービス
データソース層 -> レポジトリ

アプリケーション層のサービスクラスは登録系と参照系で分ける
それらを複合して提供するシナリオクラスを作る
シナリオクラス(基本的なサービスクラスを組み合わせた複合サービスを提供)からサービスクラスを使う                                                                                                                                                   

- 例外対応はサービスを使う側のプレゼンテーション層のクラスが責任を持つ
- シナリオクラスは細かいサービスを組み合わせているので業務の説明が
- 更新系のサービスクラスは何も情報を返さない
- domainロジックを持たない
- トランザクション、セキュリティ管理
- 新たな集約を作る必要が出てきたらファクトリか、集約のコンストラクタを使う
- イベントのサブスクライバを登録するかも？

## repository
- インターフェース宣言をdomainに追加する
- データベース操作ではなく、記録と参照の関心事で考える
- サービスクラスにテーブル設計などを意識させない


## CQRS
- command(登録系), query(参照系)
- queue -> subscriber
- イベントソーシング
- メッセージキュー


## UI
- タスクベースのUI（細かい）
- できるだけ表示用のオブジェクトを用意するより、ドメインオブジェクトをそのまま使う
  そもそも画面を見るユーザーの関心事がドメインオブジェクトであるから食い違っているのであればどちらかを見直す


## 境界づけられたコンテキスト
- Eコマースシステム、在庫システムetc...